/*
 * Noder-js 1.6.0 - 18 Jul 2014
 * https://github.com/ariatemplates/noder-js
 * Copyright 2009-2014 Amadeus s.a.s.
 * Licensed under the Apache License, Version 2.0.
 */
module.exports=function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;return function(){var a=Object.prototype.toString,c=function(b){return"string"==typeof b||"[object String]"===a.call(b)},d=Array.isArray||function(b){return"[object Array]"===a.call(b)},e=function(a){return"function"==typeof a},f=function(a){return a&&"object"==typeof a},g=function(b){return b?"[object Object]"===a.call(b):!1};b={isFunction:e,isArray:d,isString:c,isObject:f,isPlainObject:g}}(),c=process.nextTick,d=function(a){c(function(){throw a.logDetails&&a.logDetails(),a})},function(){var a=[],b=!1,f=function(a){try{a()}catch(b){d(b)}},g=function(a){for(;a.length>0;)f(a.shift())},h=function(){b=!0;try{g(a)}finally{b=!1}},i=function(d){0!==a.length||b||c(h),a.push(d)};e={syncTick:h,nextTick:i,nextTickCalls:function(a){a&&a.length>0&&i(function(){g(a)})},syncCalls:g,syncCall:f}}(),f=function(a,b,c){return function(d){return a.call(b,c,d)}},function(){var a=b.isFunction,c=b.isObject,h=function(a,b){var c,d=function(a,b){c||(c=!0,a(b))};return[f(d,null,function(c){return b&&c===b?void a[1](new TypeError):void i(c,a)}),f(d,null,a[1])]},i=function(b,d){try{if(a(b)||c(b)){var e=b.thenSync||b.then;if(a(e))return d=h(d),void e.call(b,d[0],d[1])}d[0](b)}catch(f){d[1](f)}},j=function(b){var c,d,g=this,i=[],k=function(b,e){g["then"+b]=function(b,f){return b=a(b)?b:null,f=a(f)?f:null,b||f?new j(function(a,g){var h=function(){var e=1==c?b:f;if(e)try{a(e(d))}catch(h){g(h)}else(1==c?a:g)(d)};i?i.push(h):e(h)}):g}};k("",e.nextTick),k("Sync",e.syncCall);var l=function(a){return c==a};g.isFulfilled=f(l,null,1),g.isRejected=f(l,null,2),g.result=function(){return d};var m=function(a,b){if(i){d=b,c=a;var f=i;i=null,e.nextTickCalls(f)}},n=[f(m,null,1),f(m,null,2)];n=h(n,g);try{b(n[0],n[1])}catch(o){n[1](o)}};j.resolve=function(a){return a instanceof j?a:new j(function(b){b(a)})},j.reject=function(a){return new j(function(b,c){c(a)})},j.defer=function(){var a={};return a.promise=new j(function(b,c){a.resolve=b,a.reject=c}),a},j.done=j.resolve();var k=j.prototype={},l=function(a,b){return a.apply(null,b)},m=function(a){var b="then"+a;k["spread"+a]=function(a,c){return this[b](f(l,null,a),c)},k["catch"+a]=function(a){return this[b](null,a)},k["finally"+a]=function(a){return this[b](a,a)},k["done"+a]=function(a,c){this[b](a,c).thenSync(null,d)}};m(""),m("Sync");var n=function(a){return function(b){return new j(function(c,d){if(0===b.length)return c([]);b=b.slice(0);for(var e=!0,g=b,h=b.length,j=function(f,i){b[this[0]]=i,e&&!f&&(e=!1,g=i,a&&(h=1)),h--,h||(e?c:d).call(null,g)},k=h-1;k>=0;k--){var l=[k];i(b[k],[f(j,l,!0),f(j,l,!1)])}})}};j.all=n(!0),j.allSettled=n(!1),g=j}(),function(){var a=require("fs"),b=function(b,c,d){try{d(null,a.readFileSync(b,c))}catch(e){d(e)}};h=function(c,d){return new g(function(e,f){var g=d&&d.sync?b:a.readFile;g(c,"utf-8",function(a,b){a?f(a):e({responseText:b})})})}}(),i=require("vm").runInThisContext,j=a,function(){var a,b=0,c=function(){var a=!1,b=this,c=d().thenSync(function(c){return c(b,a)});return a=!0,c},d=function(){if(!a){var b=j().errorContext,c=new v(b);a=c.moduleExecute(c.getModule(b.main))}return a},e=function(a,d,e){var f=++b,g=new Error("NoderError #"+f+": "+a);return g.name="NoderError",g.id=f,g.code=a,g.args=d,g.cause=e,g.logDetails=c,g};k=e}(),l=function(a,b,c,d){try{return i((c||"")+a+(d||""),b)}catch(e){throw k("jsEval",[a,b,c,d],e)}},function(){var a=b.isPlainObject;m=function(b,c,d){if(!b)return d;d=b["**"]||d;for(var e=0,f=c.length;f>e;e++){var g=c[e],h=b[g];if(!h)return b["*"]||b["**"]||d;if(!a(h))return h;d=b["**"]||d,b=h}return b["."]||b["*"]||b["**"]||d}}(),function(){var a=function(a){return a.length?a.split("/"):[]},b=function(b){var c=a(b);return c.pop(),c.join("/")};n={split:a,dirname:b}}(),o=function(){return __dirname+"/"},p=function(a,b,c,d){var e=(b||[]).slice(0),f=function(b){if(d[0]=b,!e.length)return g.resolve(b);var h=e.shift();return h.pattern&&h.pattern.test(c)?a.moduleAsyncRequire(a.rootModule,[h.module]).spreadSync(function(a){return g.resolve(a.apply(null,d.concat(h.options))).thenSync(f)}):f(d[0])};return f(d[0])},function(){var a=function(c,d,e){for(var f in d)if(d.hasOwnProperty(f)){var g,h=d[f];e&&b.isPlainObject(h)&&b.isPlainObject(g=c[f])?a(g,h,e):c[f]=h}};q=a}(),function(){var a=n.split,b={},c=function(a){return a.responseText},d=function(a){var c=a.config.packaging||b;this.config=c,this.baseUrl=(c.baseUrl||"").replace(/^%scriptdir%\//,o()),this.context=a,this.currentLoads={};var d=c.bootstrap;d&&d(a.define)},e=d.prototype={};e.moduleLoad=function(c){var d,e=c.filename,f=this.config.packagesMap;if(f){var g=a(e);d=m(f||b,g,null)}return d?this.loadPackaged(d):this.loadUnpackaged(c)},e.loadUnpackaged=function(a){return a.url=this.baseUrl+a.filename,h(a.url,this.config.requestConfig).thenSync(c).thenSync(f(this.preprocessUnpackaged,this,a))},e.preprocessUnpackaged=function(a,b){var c=this.config.preprocessors;return c&&c.length?p(this.context,c,a.filename,[b,a.filename]).thenSync(f(this.defineUnpackaged,this,a)):this.defineUnpackaged(a,b)},e.defineUnpackaged=function(a,b){this.context.jsModuleDefine(b,a.filename,a.url)},e.loadPackaged=function(a){var b=this,d=b.baseUrl+a,e=b.currentLoads[d];return e||(b.currentLoads[d]=e=h(d,b.config.requestConfig).thenSync(c).thenSync(function(a){var c=b.jsPackageEval(a,d);c(b.context.define)})["finally"](function(){delete b.currentLoads[d],b=null})),e},e.jsPackageEval=function(a,b){return l(a,b,"(function(define){\n","\n})")},e.updatePackagesMap=function(a){var b=this.config;b.packagesMap?q(b.packagesMap,a,!0):b.packagesMap=a},r=d}(),function(){var a=b.isString,c=n.split,d={},e=function(a){var b=a.length-1,c=a[b];-1==c.indexOf(".")&&(a[b]=c+".js")},f=function(a){for(var b=0,c=a.length;c>b;b++){var d=a[b];d.length&&"."!=d?".."==d&&b>0&&".."!=a[b-1]&&(a.splice(b-1,2),b-=2,c-=2):(a.splice(b,1),b--,c--)}return a},g=function(a,b,d){var e=c(b);e[0].length?e.unshift(d,1):(e.shift(),e.unshift(0,d+1)),a.splice.apply(a,e)},h=function(b,c){for(var d=0,e=c.length;e>d;d++){var f=c[d];if(b=b[f],!b||f===b)return!1;if(a(b))return g(c,b,d),!0}return g(c,b["."]||"index.js",c.length),!0},i=function(a,b){var c={},d=".";f(b);for(var e=b.join("/");e!==d;){if(".."==b[0])throw k("resolverRoot",[b]);if(c[e])throw k("resolverLoop",[b]);c[e]=d,h(a,b)&&f(b),d=e,e=b.join("/")}},j=function(a){this.config=a.config.resolver||d,this.cache={}},l=j.prototype={};l.moduleResolve=function(a,b){var f=c(a.filename),g=this.config["default"]||d,h=c(b),j=h[0];return("."===j||".."===j)&&(f.pop(),h=f.concat(h)),i(g,h),e(h),h.join("/")},s=j}(),t=function(){},function(){var a=/(?=[\/'"]|\brequire\s*\()/,b=/^require\s*\(\s*$/,c=/[\r\n]/,d=/^['"]$/,e=/^(\w{2,}|[!%&\(*+,\-\/:;<=>?\[\^])$/,f=/^\s*(\S)/,g=/(\b(return|throw|new|in)|\S)\s*$/,h=/\s*\)\s*\.\s*([_$a-zA-Z][_$a-zA-Z0-9]*)\s*\(\s*(?=(.?))/g,i=/[_$a-zA-Z][_$a-zA-Z0-9]*/g,j=/\s*(\)|,)\s*/g,k=function(a){for(var b=!1,c=a.length-1;c>=0&&"\\"==a.charAt(c);)c--,b=!b;return b},l=function(a,b){for(;b>=0;b--){var c=a[b];if(g.test(c))return RegExp.$1}return""},m=function(a,b){return 0===b||"."!=l(a,b-1)},n=function(a,b){return 0===b||e.test(l(a,b-1))},o=function(a,b){var c=a[b].charAt(0);b++;for(var d=a.length;d>b;b++){var e=a[b].charAt(0);if(e===c&&!k(a[b-1]))break}return b},p=function(a,b){for(var d=b+1,e=a.length;e>d;d++){var f=a[d],g=f.search(c);if(g>-1){a[d]=f.substring(g);break}}return a.splice(b,d-b),b},q=function(a,b){var c=b+1;"/*"==a[b]&&c++;for(var d=a[c-1],e=a.length;e>c;c++){var f=d;if(d=a[c],"*"==f.charAt(f.length-1)&&"/"==d.charAt(0)){a[c]=d.substring(1);break}}return a.splice(b,c-b),b},r=function(c){for(var e=[],g=[],h=0,i=c.split(a),j=i.length,k=-1;j>h&&h>=0;h++){var l=i[h],r=l.charAt(0);if("/"==r)"/"==l&&j>h+1&&"/"==i[h+1].charAt(0)?(h=p(i,h),j=i.length):"*"==l.charAt(1)?(h=q(i,h),j=i.length):n(i,h)&&(h=o(i,h));else if(d.test(r)){var s=h;h=o(i,h),e.push([s,h]),2==k&&(k=3)}else"r"==r&&b.test(l)&&m(i,h)&&(k=1);k>0&&(1==k?k=2:(l=i[h],3==k&&(l=l.substring(1),k=4),f.test(l)&&(4==k&&")"==RegExp.$1&&g.push(e.length-1),k=0)))}return[i,e,g]},s=function(a){for(var b=[0],c=1,d=a.length;d>=c;c++)b[c]=b[c-1]+a[c-1].length;return function(a){return[b[a[0]]+1,b[a[1]]]}},t=function(a,b){return a.substring.apply(a,b)},v=function(a,b,c){a.lastIndex=c;var d=a.exec(b);return d&&d.index==c?d:void 0},w=/(^|\/)\$[^\/]*$/;u=function(a,b){var c=r(a),d=c[2],e=d.length,f={},g=[];if(d.length)for(var k=s(c[0]),l=c[0].join(""),m=c[1],n=m.length,o=0;e>o;o++){var p=d[o],q=k(m[p]),u=t(l,q);if(f[u]||(g.push(u),f[u]=!0),b&&w.test(u)){var x=v(h,l,q[1]+1);if(x){var y=x[1],z=[],A=++p<n&&k(m[p]);for(x[1]=x[2];x&&")"!=x[1];){var B=x.index+x[0].length;if(A&&B+1===A[0])z.push(t(l,A)),B=A[1]+1,A=++p<n&&k(m[p]);else{if(x=v(i,l,B),!x)break;B=i.lastIndex,z.push([x[0]])}x=v(j,l,B)}x&&g.push({module:u,method:y,args:z})}}}return g}}(),function(){var a=n.dirname,c=function(a,b){return function(){return a.apply(b,arguments)}},d=function(a){var b=function(c){var d=function(){return a.moduleAsyncRequire(c,arguments)};return d.create=b,d};return b},e=function(b,c){this.dirname=c?a(c):c=".",this._noder={},this.filename=c,this.id=c,this.require=f(b.moduleRequire,b,this),this.require.resolve=f(b.moduleResolve,b,this),this.require.cache=b.cache,this.require.main=b.main,this.preloaded=!1,this.loaded=!1,this.exports={}},h=function(a,b){return a._noder[b]},i=function(a,b,c){return a._noder[b]=c,c},j=function(a){var b=a.config,c=g.done,d=b.main;c=c.thenSync(d?function(){var b=a.main=a.execModuleCall(d);return b}:function(){}),c=c.thenSync(b.onstart);var e=b.scriptsType;return e&&(c=c.thenSync(function(){return t(a,e)})),c},m=function(){},o=function(a,b,c){var d=a||b;return new d(c,b)},p=function(a){a=a||{},this.config=a,this.cache={},this.builtinModules=new m,this.allSettled=a.failFast===!1?g.allSettled:g.all;var b=new e(this);b.preloaded=!0,b.loaded=!0,b.define=this.define=c(this.define,this),b.asyncRequire=d(this)(b),b.execute=c(this.jsModuleExecute,this),b.createContext=p.createContext,this.rootModule=b,this.resolver=o(a.Resolver,s,this),this.loader=o(a.Loader,r,this),b.updatePackagesMap=c(this.loader.updatePackagesMap,this.loader);var f=a.varName;f&&(global[f]=b),j(this).done()},q=p.prototype={},w=function(a,b){if(b===a)return!0;var c=h(b,5);if(c)for(var d=0;c[d];d++)if(w(a,c[d]))return!0;return!1};q.modulePreload=function(a,b){if(a.preloaded)return g.done;var c=h(a,3),d=h(a,5);if(c||d){if(b){if(w(a,b))return g.done;d.push(b)}if(!c)throw k("modulePreloadRec",[a]);return c}var e=this;return i(a,5,b?[b]:[]),i(a,3,e.moduleLoadDefinition(a).thenSync(function(){return e.modulePreloadDependencies(a,h(a,1))}).thenSync(function(){a.preloaded=!0,i(a,3,!1),i(a,5,null)},function(b){throw k("modulePreload",[a],b)}))},q.moduleLoadDefinition=function(a){if(h(a,0))return g.done;var b=h(a,4);if(!b){var c=a.filename,d=this.builtinModules["/"+c];if(d)this.moduleDefine(a,[],d(this)),b=g.done;else{var e=!0,f=function(b){if(!h(a,0))throw k("moduleLoadDefinition",[a],b);e=!1};b=this.loader.moduleLoad(a).thenSync(f,f),e&&i(a,4,b)}}return b},q.moduleProcessPlugin=function(a,c){for(var d={module:a,__dirname:a.dirname,__filename:a.filename,"null":null},e=c.args.slice(0),f=0,g=e.length;g>f;f++){var h=e[f];if(b.isArray(h)){if(h=h[0],!d.hasOwnProperty(h))return;e[f]=d[h]}}return this.moduleExecute(this.getModule(this.moduleResolve(a,c.module))).thenSync(function(a){var b=(a[c.method]||{}).$preload;return b?b.apply(a,e):void 0}).thenSync(null,function(b){throw k("moduleProcessPlugin",[a,c],b)})},q.modulePreloadDependencies=function(a,c){for(var d=[],e=0,f=c.length;f>e;e++){var g=c[e],h=b.isString(g)?this.modulePreload(this.getModule(this.moduleResolve(a,g)),a):this.moduleProcessPlugin(a,g);d.push(h)}return this.allSettled(d)},q.moduleExecuteSync=function(a){if(a.loaded||h(a,2))return a.exports;var b=this.modulePreload(a);if(!b.isFulfilled())throw k("notPreloaded",[a],b.result());var c=a.exports;i(a,2,!0);try{return h(a,0).call(c,a,global),i(a,0,null),i(a,1,null),a.loaded=!0,a.exports}finally{i(a,2,!1)}},q.moduleResolve=function(a,b){return this.resolver.moduleResolve(a,b)},q.moduleRequire=function(a,b){return this.moduleExecuteSync(this.getModule(this.moduleResolve(a,b)))},q.getModule=function(a){if(!a)return new e(this);var b=this.cache[a];return b||(this.cache[a]=b=new e(this,a)),b},q.define=function(a,b,c){this.moduleDefine(this.getModule(a),b,c)},q.moduleDefine=function(a,b,c){return h(a,0)||(i(a,0,c),i(a,1,b),i(a,4,!1)),a},q.moduleExecute=function(a){var b=this;return b.modulePreload(a).thenSync(function(){return b.moduleExecuteSync(a)})},q.moduleAsyncRequire=function(a,c){return this.modulePreloadDependencies(a,c).thenSync(function(){for(var d=[],e=0,f=c.length;f>e;e++){var g=c[e];b.isString(g)&&(d[e]=a.require(g))}return d})},q.jsModuleDefine=function(a,b,c){var d=u(a,!0),e=this.jsModuleEval(a,c||b);return this.moduleDefine(this.getModule(b),d,e)},q.jsModuleExecute=function(a,b,c){return this.moduleExecute(this.jsModuleDefine(a,b,c))},q.jsModuleEval=function(a,b){return l(a,b,"(function(module, global){\nvar require = module.require, exports = module.exports, __filename = module.filename, __dirname = module.dirname;\n\n","\n\n})")},q.execModuleCall=function(a){return this.moduleExecute(this.getModule(this.moduleResolve(this.rootModule,a)))},p.builtinModules=m.prototype={"/noder-js/asyncRequire.js":function(a){return function(b){b.exports=a.rootModule.asyncRequire}},"/noder-js/currentContext.js":function(a){return function(b){b.exports=a}}},q.Context=p,p.createContext=function(a){return new p(a).rootModule},p.expose=q.expose=function(a,b){var c=function(a){a.exports=b};this.builtinModules["/"+a]=function(){return c}},v=p}(),w=j().mainContext,v.expose("noder-js/promise.js",g),v.expose("noder-js/context.js",v),v.expose("noder-js/findRequires.js",u),v.expose("noder-js/jsEval.js",l),v.expose("noder-js/request.js",h),v.expose("noder-js/asyncCall.js",e),x=v.createContext(w)}(function(){return{mainContext:{},errorContext:{main:"error.js",packaging:{baseUrl:"%scriptdir%/noderError/",requestConfig:{sync:!0}}}}});